#!/bin/bash

# Debug script to test config loading and filtering

echo "=== Debug: Config and Filtering ==="
echo

echo "1. Checking config file..."
if [ -f ~/.prcompass_config.yaml ]; then
    echo "✓ Config file exists at ~/.prcompass_config.yaml"
    echo "Size: $(wc -c < ~/.prcompass_config.yaml) bytes"
else 
    echo "✗ Config file not found!"
    exit 1
fi

echo
echo "2. First tab config (should be Kubernetes org):"
grep -A 15 "name.*Kubernetes" ~/.prcompass_config.yaml

echo
echo "3. My Work tab config (should filter to author:bjess9):"
grep -A 5 "name.*My Work" ~/.prcompass_config.yaml

echo
echo "4. Testing GitHub API with one of the search queries..."
echo "Searching for author:bjess9 PRs (should be limited):"
gh search prs --author=bjess9 --state=open --limit=3 --json title,createdAt,author | jq -r '.[] | "\(.title) (by \(.author.login) at \(.createdAt))"'

echo
echo "5. Testing Kubernetes org query (should be many):"
gh search prs --owner=kubernetes --state=open --limit=3 --json title,createdAt,author | jq -r '.[] | "\(.title) (by \(.author.login) at \(.createdAt))"'

echo
echo "=== Debug complete ==="